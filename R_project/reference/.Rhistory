'충북','충남','전북','전남','경북','경남','제주')
colnames(Crim) <- c(2012:2017)
Crim
rownames(Crim) <- c('서울','부산','대구','인천','광주',
'대전','울산','세종','경기','강원',
'충북','충남','전북','전남','경북','경남','제주')
colnames(Crim) <- c(2012:2017)
Crim <- data.frame(nrow = 6, ncol = 17)
rownames(Crim) <- c('서울','부산','대구','인천','광주',
'대전','울산','세종','경기','강원',
'충북','충남','전북','전남','경북','경남','제주')
colnames(Crim) <- c(2012:2017)
colnames(Crim) <- c('서울','부산','대구','인천','광주',
'대전','울산','세종','경기','강원',
'충북','충남','전북','전남','경북','경남','제주')
rownames(Crim) <- c(2012:2017)
Crim2012
Crim2012[,1]
Crim2012[,2]
Crim2012[,3]
sum(Crim2012[,c(3,ncol(Crim2012))])
sum(Crim2012[,3])
sum(Crim2012[,'서울'])
sum(Crim2012[,c(3:ncol(Crim2012))])
A <- sum(Crim2012[,c(3:ncol(Crim2012))])
A
A <- colSums(Crim2012[,c(3:ncol(Crim2012))])
A
colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2016 <- colSums(Crim2017[ , c( 3:ncol(Crim2016) ) ] )
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2015 <- colSums(Crim2015[ , c( 3:nocl(Crim2015) ) ] )
cs2014 <- colSums(Crim2014[ , c( 3:nocl(Crim2014) ) ] )
cs2013 <- colSums(Crim2013[ , c( 3:nocl(Crim2013) ) ] )
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2015 <- colSums(Crim2015[ , c( 3:ncol(Crim2015) ) ] )
cs2014 <- colSums(Crim2014[ , c( 3:ncol(Crim2014) ) ] )
cs2013 <- colSums(Crim2013[ , c( 3:ncol(Crim2013) ) ] )
cs2012 <- colSums(Crim2012[ , c( 3:ncol(Crim2012) ) ] )
cs2017
cs2012
cs2017[1]
for(i in 1:ncol(cs2017)){
if(cs2017$i %in% '경기') print('1')
}
if(cs2017[,i] %in% '경기') print('1')
if(cs2017[i] %in% '경기') print('1')
str(cs2012)
if(names(cs2017) %in% '경기') print('1')
#for(i in 1:ncol(cs2017)){
if(names(cs2017) %in% '경기') print('1')
#for(i in 1:ncol(cs2017)){
x=sum(cs2017[cs2017 %in% '경기'])
x
#for(i in 1:ncol(cs2017)){
x <- sum(cs2017[cs2017 %in% '경기'])
x
#for(i in 1:ncol(cs2017)){
x <- sum(
cs2017[ cs2017 %in% '경기' ]
)
#for(i in 1:ncol(cs2017)){
x <- sum(
cs2017 %in% '경기' ]
)
#for(i in 1:ncol(cs2017)){
x <- sum(
cs2017 %in% '경기'
)
cs2017 <- data.frame(colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] ))
#for(i in 1:ncol(cs2017)){
cs2017
str(cs2012)
cs2017
cs2017['제주.서귀포','제주.제주']
cs2017['제주.서귀포']
cs2017[서울울]
cs2017[서울]
cs2017['서울']
cs2017[1]
cs2017$서울울
cs2017$서울
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2017$서울
cs2017$'서울'
cs2017[,1]
cs2017[1]
cs2017[2]
# 범죄 부문 12-17 x 년도 시계열 y 범죄수 추계 라인1 범죄수 라인2 CCTV 추가 설치 제주
Crim2017 <- read.csv(file = 'crim_area2017.csv', header = T)
Crim2016 <- read.csv(file = 'crim_area2016.csv', headaer = T)
Crim2015 <- read.csv(file = 'crim_area2015.csv', header = T)
Crim2014 <- read.csv(file = 'crim_area2014.csv', header = T)
Crim2013 <- read.csv(file = 'crim_area2013.csv', header = T)
Crim2012 <- read.csv(file = 'crim_area2012.csv', header = T)
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2015 <- colSums(Crim2015[ , c( 3:ncol(Crim2015) ) ] )
cs2014 <- colSums(Crim2014[ , c( 3:ncol(Crim2014) ) ] )
cs2013 <- colSums(Crim2013[ , c( 3:ncol(Crim2013) ) ] )
Crim2016 <- read.csv(file = 'crim_area2016.csv', headaer = T)
Crim2016 <- read.csv(file = 'crim_area2016.csv', header = T)
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2015 <- colSums(Crim2015[ , c( 3:ncol(Crim2015) ) ] )
cs2014 <- colSums(Crim2014[ , c( 3:ncol(Crim2014) ) ] )
cs2013 <- colSums(Crim2013[ , c( 3:ncol(Crim2013) ) ] )
cs2012 <- colSums(Crim2012[ , c( 3:ncol(Crim2012) ) ] )
Crim_Area %>% bind_rows(cs2017,cs2016,cs2015,cs2014,cs2013,cs2012)
cs2017
crim2017 <- read.xlsx(file = 'crim_area2017.xlsx', sheetIndex = 1, encoding = 'UTF-8')
Crim2017 <- read.xlsx(file = 'crim_area2017.xlsx', sheetIndex = 1, encoding = 'UTF-8')
Korea_Population <- read.csv(file = 'korea_population.csv',
header = TRUE,
stringsAsFactors = FALSE)
Korea_Population
Crim_Area %>% bind_rows(cs2017)
# 범죄 부문 12-17 x 년도 시계열 y 범죄수 추계 라인1 범죄수 라인2 CCTV 추가 설치 제주
Crim2017 <- read.csv(file = 'crim_area2017.csv', header = T)
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2017
Crim_Area %>% bind_rows(cs2017)
cs2017
crim_area %>% bind_rows(cs2017)
crim_area <- data.frame()
crim_area %>% bind_rows(cs2017)
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
plot(crim_area)
Crim2016 <- read.csv(file = 'crim_area2016.csv', header = T)
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2016
crim_area %>% bind_rows(cs2017,cs2016)
rownames(c(2017:2016))
rownames(crim_area)c(2017:2016)
rownames(crim_area) <- c(2017:2016)
rownames(crim_area) <- c(2017, 2016)
rownames(crim_area) <- c('2017', '2016')
rownames(crim_area) <- c(1, 2017, 2016)
rownames(crim_area) <- c(2017)
row.names(crim_area) <- c(2017, 2016)
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
plot(crim_area)
crim_area
cs2017
cs2016
crim_area <- data.frame()
crim_area %>% bind_rows(cs2017,cs2016)
crim_area
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
rownames(crim_area) <- c(2017, 2016)
crim_area
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
plot(crim_area)
rownames(crim_area) <- c(2017, 2016)
crim_area
# 복수의 선 그래프
late1 <- c(5,8,7,9,4,6,12,13,8,6,6,4)
late2 <- c(4,6,5,8,7,8,10,11,6,5,7,3)
plot(month, late1, main = '지각생통계',
type = 'b', lty= 1, col = 'red',
xlab = 'Month', ylab = 'late cnt',
ylim = c(1,15) )                   # ylim : y 좌표 범위
lines(month, late2, type = 'b', col = 'blue' )
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
plot(crim_area[1])
month <- 1:12
late <- c(5,8,7,9,4,6,12,13,8,6,6,4)
plot(month, late, main = '지각생통계',
type = 'l', lty= 1, lwd = 1,
xlab = 'Month', ylab = 'late cnt' )      # lty : line type, lwd : line width
plot(year, cs2017, main = '연차별 범죄 수',
type = 'l', lty= 1, lwd = 1,
xlab = '연차', ylab = '범죄 수' )
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
year <- 2012:2017
plot(year, cs2017, main = '연차별 범죄 수',
type = 'l', lty= 1, lwd = 1,
xlab = '연차', ylab = '범죄 수' )
cs2017
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
year <- 12:17
plot(year, cs2017, main = '연차별 범죄 수',
type = 'l', lty= 1, lwd = 1,
xlab = '연차', ylab = '범죄 수' )
month <- 1:100
late <- c(5,8,7,9,4,6,12,13,8,6,6,4)
plot(month, late, main = '지각생통계',
type = 'l', lty= 1, lwd = 1,
xlab = 'Month', ylab = 'late cnt' )      # lty : line type, lwd : line width
month <- 1:12
late <- c(5,8,7,9,4,6,12,13,8,6,6,4)
plot(month, late, main = '지각생통계',
type = 'l', lty= 1, lwd = 1,
xlab = 'Month', ylab = 'late cnt' )      # lty : line type, lwd : line width
plot(year, cs2017, main = '연차별 범죄 수',
type = 'l', lty= 1, lwd = 1,
xlab = '연차', ylab = '범죄 수' )
plot(year, apply(crim_area,2,rev), main = '연차별 범죄 수',
type = 'l', lty= 1, lwd = 1,
xlab = '연차', ylab = '범죄 수' )
crim_area <- data.frame()
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
rownames(crim_area) <- c(2017, 2016)
#시계열 분석 : L1 -  연차별 범죄율 수, L2 - 연차별 CCTV 설치 수
year <- 2016:2017
plot(year, apply(crim_area,2,rev), main = '연차별 범죄 수',
type = 'l', lty= 1, lwd = 1,
xlab = '연차', ylab = '범죄 수' )
crim_area
crim_area
Korea_Population
Korea_Population <- read.csv(file = 'korea_population.csv',
header = TRUE,
stringsAsFactors = FALSE)
Korea_Population
# 서울CCTV
cctv_Seoul <- read.csv( file = 'cctv_Seoul.csv',
header = TRUE,
stringsAsFactors = FALSE)
str(cctv_Seoul)
# numeric and substr year, month
cctv_Seoul$설치년월.year <- as.numeric(substr(cctv_Seoul$설치년월,1,4))
cctv_Seoul$설치년월.month <- as.numeric(substr(cctv_Seoul$설치년월,6,7))
# 부산CCTV
cctv_Busan <- read.csv( file = 'cctv_Busan.csv',
header = TRUE,
stringsAsFactors = FALSE)
str(cctv_Busan)
# numeric and substr year, month
cctv_Busan$설치년월.year <- as.numeric(substr(cctv_Busan$설치년월,1,4))
cctv_Busan$설치년월.month <- as.numeric(substr(cctv_Busan$설치년월,6,7))
# 대구CCTV
cctv_Daegu <- read.csv( file = 'cctv_Daegu.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Daegu$설치년월.year <- as.numeric(substr(cctv_Daegu$설치년월,1,4))
cctv_Daegu$설치년월.month <- as.numeric(substr(cctv_Daegu$설치년월,6,7))
# 인천CCTV
cctv_Incheon <- read.csv( file = 'cctv_Incheon.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Incheon$설치년월.year <- as.numeric(substr(cctv_Incheon$설치년월,1,4))
cctv_Incheon$설치년월.month <- as.numeric(substr(cctv_Incheon$설치년월,6,7))
# 광주CCTV
cctv_Gwangju <- read.csv( file = 'cctv_Gwangju.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Gwangju$설치년월.year <- as.numeric(substr(cctv_Gwangju$설치년월,1,4))
cctv_Gwangju$설치년월.month <- as.numeric(substr(cctv_Gwangju$설치년월,6,7))
# 대전CCTV
cctv_Daejeon <- read.csv( file = 'cctv_Daejeon.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Daejeon$설치년월.year <- as.numeric(substr(cctv_Daejeon$설치년월,1,4))
cctv_Daejeon$설치년월.month <- as.numeric(substr(cctv_Daejeon$설치년월,6,7))
# 울산 CCTV
cctv_Ulsan <- read.csv( file = 'cctv_Ulsan.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Ulsan$설치년월.year <- as.numeric(substr(cctv_Ulsan$설치년월,1,4))
cctv_Ulsan$설치년월.month <- as.numeric(substr(cctv_Ulsan$설치년월,6,7))
# 세종 CCTV
cctv_Saejong <- read.csv( file = 'cctv_Saejong.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Saejong$설치년월.year <- as.numeric(substr(cctv_Saejong$설치년월,1,4))
cctv_Saejong$설치년월.month <- as.numeric(substr(cctv_Saejong$설치년월,6,7))
# 경기 CCTV
cctv_Gyounggi <- read.csv( file = 'cctv_Gyounggi.csv',
header = TRUE,
stringsAsFactors = FALSE)
str(cctv_Gyounggi)
# numeric and substr year, month
cctv_Gyounggi$설치년월.year <- as.numeric(substr(cctv_Gyounggi$설치년월,1,4))
cctv_Gyounggi$설치년월.month <- as.numeric(substr(cctv_Gyounggi$설치년월,6,7))
# 강원 CCTV
cctv_Gangwon <- read.csv( file = 'cctv_Gangwon.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_Gangwon$설치년월.year <- as.numeric(substr(cctv_Gangwon$설치년월,1,4))
cctv_Gangwon$설치년월.month <- as.numeric(substr(cctv_Gangwon$설치년월,6,7))
# 충북 CCTV
cctv_CNorth <- read.csv( file = 'cctv_CNorth.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_CNorth$설치년월.year <- as.numeric(substr(cctv_CNorth$설치년월,1,4))
cctv_CNorth$설치년월.month <- as.numeric(substr(cctv_CNorth$설치년월,6,7))
# 충남 CCTV
cctv_CSouth <- read.csv( file = 'cctv_CSouth.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_CSouth$설치년월.year <- as.numeric(substr(cctv_CSouth$설치년월,1,4))
cctv_CSouth$설치년월.month <- as.numeric(substr(cctv_CSouth$설치년월,6,7))
# 전북 CCTV
cctv_JNorth <- read.csv( file = 'cctv_JNorth.csv',
header = TRUE,
stringsAsFactors = FALSE)
str(cctv_JNorth)
# numeric and substr year, month
cctv_JNorth$설치년월.year <- as.numeric(substr(cctv_JNorth$설치년월,1,4))
cctv_JNorth$설치년월.month <- as.numeric(substr(cctv_JNorth$설치년월,6,7))
# 전남 CCTV
cctv_JSouth <- read.csv( file = 'cctv_JSouth.csv',
header = TRUE,
stringsAsFactors = FALSE)
str(cctv_JSouth)
# numeric and substr year, month
cctv_JSouth$설치년월.year <- as.numeric(substr(cctv_JSouth$설치년월,1,4))
cctv_JSouth$설치년월.month <- as.numeric(substr(cctv_JSouth$설치년월,6,7))
# 경북 CCTV
cctv_KNorth <- read.csv( file = 'cctv_KNorth.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_KNorth$설치년월.year <- as.numeric(substr(cctv_KNorth$설치년월,1,4))
cctv_KNorth$설치년월.month <- as.numeric(substr(cctv_KNorth$설치년월,6,7))
# 경남 CCTV
cctv_KSouth <- read.csv( file = 'cctv_KSouth.csv',
header = TRUE,
stringsAsFactors = FALSE)
# numeric and substr year, month
cctv_KSouth$설치년월.year <- as.numeric(substr(cctv_KSouth$설치년월,1,4))
cctv_KSouth$설치년월.month <- as.numeric(substr(cctv_KSouth$설치년월,6,7))
# 제주 CCTV
cctv_Jeju <- read.csv( file = 'cctv_Jeju.csv',
header = TRUE,
stringsAsFactors = FALSE)
str(cctv_Jeju)
# numeric and substr year, month
cctv_Jeju$설치년월.year <- as.numeric(substr(cctv_Jeju$설치년월,1,4))
cctv_Jeju$설치년월.month <- as.numeric(substr(cctv_Jeju$설치년월,6,7))
#설치년도 기준 : 1990~2019
boxplot(cctv_Seoul$설치년월.year, main = '서울CCTV설치년도')  #일제시대
boxplot(cctv_Busan$설치년월.year, main = '부산CCTV설치년도')  #미래
boxplot(cctv_Daegu$설치년월.year, main = '대구CCTV설치년도')  #미래
boxplot(cctv_Incheon$설치년월.year, main = '인천CCTV설치년도')#미래
boxplot(cctv_Gwangju$설치년월.year, main = '광주CCTV설치년도')
boxplot(cctv_Daejeon$설치년월.year, main = '대전CCTV설치년도')
boxplot(cctv_Ulsan$설치년월.year, main = '울산CCTV설치년도')
boxplot(cctv_Saejong$설치년월.year, main = '세종CCTV설치년도')  # 연월일 기재되지 않음
boxplot(cctv_Gyounggi$설치년월.year, main = '경기CCTV설치년도') #미래
boxplot(cctv_Gangwon$설치년월.year, main = '강원CCTV설치년도') #일제강점기
boxplot(cctv_CNorth$설치년월.year, main = '충북CCTV설치년도')
boxplot(cctv_CSouth$설치년월.year, main = '충남CCTV설치년도') #미래
boxplot(cctv_JNorth$설치년월.year, main = '전북CCTV설치년도') #일제강점기
boxplot(cctv_JSouth$설치년월.year, main = '전남CCTV설치년도') #미래
boxplot(cctv_KNorth$설치년월.year, main = '경북CCTV설치년도') #미래 & 이승만하야시기
boxplot(cctv_KSouth$설치년월.year, main = '경남CCTV설치년도')
boxplot(cctv_Jeju$설치년월.year, main = '제주CCTV설치년도')
cctv_Seoul$설치년월.year[ cctv_Seoul$설치년월.year < 1990 | cctv_Seoul$설치년월.year > 2019 ] <- NA
cctv_Busan$설치년월.year[ cctv_Busan$설치년월.year < 1990 | cctv_Busan$설치년월.year > 2019 ] <- NA
cctv_Daegu$설치년월.year[ cctv_Daegu$설치년월.year < 1990 | cctv_Daegu$설치년월.year > 2019 ] <- NA
cctv_Incheon$설치년월.year[ cctv_Incheon$설치년월.year < 1990 | cctv_Incheon$설치년월.year > 2019 ] <- NA
cctv_Gyounggi$설치년월.year[ cctv_Gyounggi$설치년월.year < 1990 | cctv_Gyounggi$설치년월.year > 2019 ] <- NA
cctv_Gangwon$설치년월.year[ cctv_Gangwon$설치년월.year < 1990 | cctv_Gangwon$설치년월.year > 2019 ] <- NA
cctv_CSouth$설치년월.year[ cctv_CSouth$설치년월.year < 1990 | cctv_CSouth$설치년월.year > 2019 ] <- NA
cctv_JNorth$설치년월.year[ cctv_JNorth$설치년월.year < 1990 | cctv_JNorth$설치년월.year > 2019 ] <- NA
cctv_JSouth$설치년월.year[ cctv_JSouth$설치년월.year < 1990 | cctv_JSouth$설치년월.year > 2019 ] <- NA
cctv_KNorth$설치년월.year[ cctv_KNorth$설치년월.year < 1990 | cctv_KNorth$설치년월.year > 2019 ] <- NA
# CCTV설치 갯수 이상치는 수정 X => 관할기관이름으로 묶여있어 해당 기관 활용 목적이 있기 판단했기 때문
boxplot(cctv_Seoul$카메라대수, main = '서울CCTV수' )
boxplot(cctv_Busan$카메라대수, main = '부산CCTV수' )
boxplot(cctv_Daegu$카메라대수, main = '대구CCTV수' )
boxplot(cctv_Incheon$카메라대수, main = '인천CCTV수' )
boxplot(cctv_Gwangju$카메라대수, main = '광주CCTV수' )
boxplot(cctv_Daejeon$카메라대수, main = '대전CCTV수' ) #100개? 대전 동구청 관할
boxplot(cctv_Ulsan$카메라대수, main = '울산CCTV수' )
boxplot(cctv_Saejong$카메라대수, main = '세종CCTV수' )
boxplot(cctv_Gyounggi$카메라대수, main = '경기CCTV수' )
boxplot(cctv_Gangwon$카메라대수, main = '강원CCTV수' )  #강원랜드 관할 983개, 100개 100개..
boxplot(cctv_CNorth$카메라대수, main = '충북CCTV수' )
boxplot(cctv_CSouth$카메라대수, main = '충남CCTV수' ) #300개? 충남도청주소인 것으로보아 도청서 직접관할하는 CCTV로 추정
boxplot(cctv_JNorth$카메라대수, main = '전북CCTV수' )
boxplot(cctv_JSouth$카메라대수, main = '전남CCTV수' )
boxplot(cctv_KNorth$카메라대수, main = '경북CCTV수' )
boxplot(cctv_KSouth$카메라대수, main = '경남CCTV수' )
boxplot(cctv_Jeju$카메라대수, main = '제주CCTV수' ) #이상치1개 : 제주 클린하우스(= 제주 전역 생활 쓰레기 수거지)
Korea_Population$cctv_cnt <- c( sum(cctv_Seoul$카메라대수), sum(cctv_Busan$카메라대수), sum(cctv_Daegu$카메라대수), sum(cctv_Incheon$카메라대수),
sum(cctv_Gwangju$카메라대수), sum(cctv_Daejeon$카메라대수), sum(cctv_Ulsan$카메라대수), sum(cctv_Saejong$카메라대수),
sum(cctv_Gyounggi$카메라대수), sum(cctv_Gangwon$카메라대수), sum(cctv_CNorth$카메라대수), sum(cctv_CSouth$카메라대수),
sum(cctv_JNorth$카메라대수), sum(cctv_JSouth$카메라대수), sum(cctv_KNorth$카메라대수), sum(cctv_KSouth$카메라대수),
sum(cctv_Jeju$카메라대수))
Korea_Population <- Korea_Population %>%
arrange( cctv_cnt )
barplot( Korea_Population$cctv_cnt,
main = '지역별 공공 cctv 설치 수',
names.arg = Korea_Population$지역,
xlab = '지역', ylab = 'cctv 설치 수',
border = NA)
Korea_Population <- Korea_Population %>%
mutate( ratio = cctv_cnt / 인구 * 1000  ) %>%
arrange( ratio )
barcolor = c('gray','red')[(Korea_Population$ratio > 15) + 1]
barplot( Korea_Population$ratio,
main = '지역별 인구대비 공공 cctv 설치 지수',
names.arg = Korea_Population$지역,
xlab = '지역', ylab = 'CCTV설치수/인구*1000',
col = barcolor, border = NA )
# 범죄 부문 12-17 x 년도 시계열 y 범죄수 추계 라인1 범죄수 라인2 CCTV 추가 설치 제주
Crim2017 <- read.csv(file = 'crim_area2017.csv', header = T)
Crim2016 <- read.csv(file = 'crim_area2016.csv', header = T)
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2017
cs2016
crim_area <- data.frame()
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
rownames(crim_area) <- c(2017, 2016)
year <- 2016:2017
crim_area
Korea_Population
crim_area <- apply(crim_area,2,rev)
crim_area
crim_area <- data.frame()
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
rownames(crim_area) <- c(2017, 2016)
year <- 2016:2017
cs2016
Korea_Population
Korea_Population$지역 ==
crim_area
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
rownames(crim_area) <- c(2017, 2016)
year <- 2016:2017
Korea_Population$지역 ==
crim_area
cs2017 <- colSums(Crim2017[ , c( 3:ncol(Crim2017) ) ] )
cs2016 <- colSums(Crim2016[ , c( 3:ncol(Crim2016) ) ] )
cs2017
cs2016
crim_area <- data.frame()
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
Korea_Population$지역 ==
crim_area
crim_area <- data.frame()
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
crim_area
rownames(crim_area) <- c(2017, 2016)
crim_area
str(crim_area)
rownames(crim_area) <- c(2017, 2016)
str(crim_area)
str(Korea_Population)
df <- merge(Korea_Population, crim_area)
df
df1 <- apply(crim_area, 2, rev)
df1
df <- merge(Korea_Population, df1)
df
crim_area <- data.frame()
crim_area <- crim_area %>% bind_rows(cs2017,cs2016)
rownames(crim_area) <- c(2017, 2016)
rotatedf <- apply(crim_area, 2, rev)
rotatedf
df <- merge(Korea_Population, rotatedf, all.x = T)
df
df2 <- merge(Korea_Population, rotatedf, all.x = T)
df2
cctv_Jeju
plot(crim_area,cctv_Jeju$설치년월.year)
plot(cctv_Jeju)
cctv_Jeju
rownames(crim_area) <- c(2017, 2016)
crim_area
df <- left_join(Korea_Population,crim_area, by='지역')
df <- full_join(Korea_Population,crim_area)
cctv_Jeju$설치년월.year[ cctv_Jeju$설치년월.year < 1990 | cctv_Jeju$설치년월.year > 2019 | cctv_Jeju = '' ] <- NA
cctv_Jeju
# Matrix / Data Frame 열별 결측치 확인
# case 1 : 반복문 이용
for(i in 1:ncol(x)){
this.na <- is.na( x[,i] )
cat( colnames(x)[i], '\t', sum(this.na), '\n' )
}
# case 2 : apply() 이용
col_na <- function( y ){
return ( sum( is.na(y) )  )
}
na_cnt <- apply(x,2,col_na) # na_cnt <- apply(x,2,function(y) sum(is.na(y)) )     ## 익명 함수
na_cnt
barplot( na_cnt[ na_cnt > 0 ] )
# Matrix / Data Frame 결측치 처리
x <- iris
x[1,2] <- NA
x[1,3] <- NA
x[2,3] <- NA
x[3,4] <- NA
head(x)
# Matrix / Data Frame 열별 결측치 확인
# case 1 : 반복문 이용
for(i in 1:ncol(x)){
this.na <- is.na( x[,i] )
cat( colnames(x)[i], '\t', sum(this.na), '\n' )
}
# case 2 : apply() 이용
col_na <- function( y ){
return ( sum( is.na(y) )  )
}
na_cnt <- apply(x,2,col_na) # na_cnt <- apply(x,2,function(y) sum(is.na(y)) )     ## 익명 함수
na_cnt
barplot( na_cnt[ na_cnt > 0 ] )
